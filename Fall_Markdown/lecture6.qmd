---
format: 
  revealjs:
    slide-number: true
    logo: images/image-393370223.png
    scrollable: true 
    theme: theme.scss
editor: visual
fontsize: 24pt
---

</br></br>

<h1 style="text-align: center">

6 ç®€å•çº¿æ€§å›å½’

</h1>

<h2 style="text-align: center">

</h2>

</br></br>

<h3 style="text-align: center">

Hu Chuan-Peng

</h3>

<h3 style="text-align: center">

2023-10-17

</h3>

</br></br>

# æœ¬æ¬¡è¯¾å†…å®¹

-   è¯¾å‰å¤ä¹ 

-   ç®€å•çº¿æ€§å›å½’

-   å‚æ•°ä¼°è®¡

-   åŸºæœ¬å‡å®šå’Œworkflow

# è¯¾å‰å¤ä¹ 

## çº¿æ€§å›å½’è§£è¯»çš„ä¸‰ç§è§†è§’

$$è§‚æµ‹é¡¹=ç»“æ„é¡¹+éšæœºé¡¹$$

-   è§‚æµ‹é¡¹ï¼šå› å˜é‡çš„å®é™…å–å€¼

-   ç»“æ„é¡¹ï¼šå› å˜é‡ä¸è‡ªå˜é‡é—´çš„ç»“æ„å…³ç³»ï¼Œ"é¢„æµ‹å€¼"

-   éšæœºé¡¹ï¼šè§‚æµ‹é¡¹ä¸­æœªè¢«ç»“æ„é¡¹è§£é‡Šçš„çš„éƒ¨åˆ†ï¼ŒåŒ…å«è¢«å¿½ç•¥çš„ç»“æ„å› ç´ ï¼Œæµ‹é‡è¯¯å·®å’Œéšæœºå¹²æ‰°

## æè¿°æ€§

$$è§‚æµ‹é¡¹=æ¦‚æ‹¬é¡¹+æ®‹å·®é¡¹$$

-   ä¸å…³æ³¨æ¨¡å‹æ˜¯å¦"çœŸå®"ï¼Œåªå…³æ³¨æ˜¯å¦ç¬¦åˆå·²è¢«è§‚å¯Ÿåˆ°çš„äº‹å®ã€‚

-   "å¥¥å¡å§†å‰ƒåˆ€å®šå¾‹"ï¼šå¦‚æœè®¸å¤šæ¨¡å‹å¯¹æ‰€è§‚å¯Ÿçš„äº‹å®è§£é‡Šç¨‹åº¦å¾—å½“ï¼Œé™¤éæœ‰å…¶ä»–è¯æ®æ”¯æŒæŸä¸€æ¨¡å‹ï¼Œå¦åˆ™æˆ‘ä»¬å€¾å‘äºé€‰æ‹© æœ€ç®€å•çš„æ¨¡å‹

## é¢„æµ‹æ€§

$$è§‚æµ‹é¡¹ = é¢„æµ‹é¡¹ + è¯¯å·®é¡¹$$

-   å·²çŸ¥ä¸€ç»„è‡ªå˜é‡å’Œå› å˜é‡ä¹‹é—´çš„å…³ç³»ï¼Œç”¨æ–°çš„æ•°æ®ç»™å‡ºæœ‰ç”¨çš„é¢„æµ‹å›ç­”ï¼Œé€šè¿‡ç»éªŒè§„å¾‹åšé¢„æµ‹ï¼Œå¯¹å› æœæœºåˆ¶ä¸åœ¨ä¹æˆ–ä¸æ„Ÿå…´è¶£ã€‚

## å› æœæ€§

$$è§‚æµ‹é¡¹ = æœºåˆ¶é¡¹ + å¹²æ‰°é¡¹$$

-   ç¡®ç«‹æ¨¡å‹ä»¥å‘ç°æ•°æ®äº§ç”Ÿçš„æœºåˆ¶ï¼Œå‘ç°"çœŸå®"çš„å› æœæ¨¡å‹ï¼Œä½†å½“å‰æ›´å¤šå­¦è€…è®¤ä¸ºï¼Œè¿™ç§æ¨¡å‹å¹¶ä¸å­˜åœ¨ï¼Œå¥½çš„æ¨¡å‹åªæ˜¯æ›´æ¥è¿‘çœŸå®ï¼Œæˆ–æ›´æœ‰æ„ä¹‰

## çº¿æ€§å›å½’è¡¨è¾¾å¼

</br>

$y = a + bX + \epsilon$

</br>

-   y -- Data

-   a+bX -- model

-   $\epsilon$ -- error

## çº¿æ€§å›å½’å˜å¼‚åˆ†è§£

::: {layout-ncol="2"}
![](images/6.1.jpg){fig-align="center"}

![](images/6.2.png){fig-align="center"}
:::

## æ¨¡å‹æ€§èƒ½è¯„ä¼°

$$R^2=\frac{SS_{R}}{SS_{T}}=\frac{\sum(y_{i}-\hat{y_{i}})^2}{\sum(y_{i}-\bar{y_{i}})^2}$$

# Part 1 ç®€å•çº¿æ€§å›å½’è¡¨è¾¾å½¢å¼

## çº¿æ€§å›å½’è¡¨è¾¾å¼

$$y = a + bX + \epsilon$$

-   y -- å› å˜é‡ï¼ŒDependent variable

-   x -- è‡ªå˜é‡ï¼ŒIndependent (explanatory) variable

-   a -- æˆªè·ï¼ŒIntercept

-   b -- æ–œç‡ï¼ŒSlope

-   $\epsilon$ -- æ®‹å·®ï¼ŒResidual (error)

## çº¿æ€§ä»£æ•°è¡¨è¾¾

$$y_i=a+bx_i+\epsilon $$

$$\downarrow$$

$$Y_1=\alpha +\beta_1 X_1+\epsilon_1$$

$$Y_2=\alpha +\beta_1 X_2+\epsilon_2$$

$$...$$

$$Y_n=\alpha +\beta_1 X_n+\epsilon_n$$

## çŸ©é˜µè¡¨è¾¾

$$Y_{nÃ—1}=X_{nÃ—2}\beta_{2Ã—1}+\epsilon_{nÃ—1}$$

$$Y=X\beta+\epsilon$$

::: {layout-ncol="6"}
$$Y_{nÃ—1}=\begin{bmatrix}
  y_1 \\
  y_2 \\
  ... \\
  y_n
\end{bmatrix}$$

$$X_{nÃ—2}=\begin{bmatrix}
  1&x_{12} \\
  1&x_{22} \\
  ...&... \\
  1&x_{n2}
\end{bmatrix}$$

$$\beta_{2Ã—1}=\begin{bmatrix}
 \alpha\\
\beta_1\end{bmatrix}$$

$$\epsilon_{nÃ—1}=\begin{bmatrix}
 \epsilon_1\\
  \epsilon_2\\
  ...\\
  \epsilon_n\end{bmatrix}$$
:::

## ä»£ç è¡¨è¾¾(r)

</br>

Formula=Y\~X

</br>

Y: å› å˜é‡ X: è‡ªå˜é‡

## å®ä¾‹è®²è§£

</br>

æ”¶å…¥ä¸é—®é¢˜è§£å†³èƒ½åŠ›æ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ

</br>

æ•°æ®ï¼š "HouseholdIncome"(æˆ¿äº§æ”¶å…¥)å’Œ"Ravens.score"(ç‘æ–‡æ¨ç†æµ‹éªŒ)è¿™ä¸¤ä¸ªå˜é‡è¿›è¡Œç ”ç©¶(Eisenberg et al., 2019)

## 

è‹¥æˆ‘ä»¬åªå–å‰4ä¸ªæ ·æœ¬çš„æ•°æ®ï¼š

|       |     |
|-------|-----|
| Y     | X   |
| 40000 | 2   |
| 19500 | 4   |
| 60000 | 3   |
| 81000 | 9   |

## 

ç”¨çº¿æ€§æ–¹ç¨‹è¡¨ç¤ºä¸ºï¼š

$$40000=\alpha +2*\beta_1 +\epsilon_1$$

$$19500=\alpha +4*\beta_1 +\epsilon_2$$

$$60000=\alpha +3*\beta_1 +\epsilon_3$$

$$81000=\alpha +9*\beta_1 +\epsilon_4$$

## 

ç”¨çŸ©é˜µè¡¨ç¤ºï¼š

$$\begin{bmatrix}
  40000 \\
  19500 \\
  60000 \\
  81000
\end{bmatrix}=\alpha+\beta\begin{bmatrix}
  2 \\
  4 \\
  3 \\
  9
\end{bmatrix}+\begin{bmatrix}
 \epsilon_1\\
  \epsilon_2\\
  \epsilon_3\\
  \epsilon_4\end{bmatrix}$$

## è¡¥å……çŸ¥è¯†ï¼šçŸ©é˜µè¿ç®—

çŸ©é˜µçš„åŠ å‡æ³•

$$nè¡Œmåˆ—çš„XÂ±Y$$

::: {layout-ncol="2"}
$$X=\begin{bmatrix}
  x_{11}&x_{12}  &...  &x_{1m} \\
  x_{21}&x_{22}  &...  &x_{2m} \\
  ...&...  &...  &... \\...
  x_{n1}&x_{n2}  &...  &x_{nm}
\end{bmatrix}$$

$$Y=\begin{bmatrix}
  y_{11}&y_{12}  &...  &y_{1m} \\
  y_{21}&y_{22}  &...  &y_{2m} \\
  ...&...  &...  &... \\...
  y_{n1}&y_{n2}  &...  &y_{nm}
\end{bmatrix}$$
:::

$$XÂ±Y=\begin{bmatrix}
  x_{11}Â±y_{11}&x_{12}Â±y_{12}  &...  &x_{1m}Â±y_{1m} \\
  x_{21}Â±y_{21}&x_{22}Â±y_{22}  &...  &x_{2m}Â±y_{2m} \\
  ...&...  &...  &... \\...
  x_{n1}Â±y_{n1}&x_{n2}Â±y_{n2}  &...  &x_{nm}Â±y_{nm}
\end{bmatrix}$$

## 

$$C=A+B=X=\begin{bmatrix}
  2&4 &-1 \\
  1&8 &7 \\
  3&5 &6
\end{bmatrix}+\begin{bmatrix}
  7&5 &2 \\
  9&-3 &1 \\
  2&1 &8
\end{bmatrix}=\begin{bmatrix}
  9&9 &1 \\
  10&5 &8 \\
  5&6 &14
\end{bmatrix}$$

## çŸ©é˜µçš„ä¹˜æ³•

å‡è®¾æœ‰ç»´æ•°æœ‰n Ã— m çš„çŸ©é˜µXï¼Œä»¥åŠç»´åº¦ä¸ºl Ã— kçš„çŸ©é˜µYï¼Œåˆ™

1.  å½“ m = l æ—¶ï¼ŒçŸ©é˜µXä¹˜ä»¥çŸ©é˜µYæ‰æ˜¯å¯è¡Œçš„ï¼Œç»“æœçŸ©é˜µXYæ‰å­˜åœ¨ï¼›

2.  å½“ k = n æ—¶ï¼ŒçŸ©é˜µYä¹˜ä»¥çŸ©é˜µXæ‰æ˜¯å¯è¡Œçš„ï¼Œç»“æœçŸ©é˜µYXæ‰å­˜åœ¨ã€‚

ä¸‹é¢å‡è®¾m = l æˆç«‹ï¼Œåˆ™çŸ©é˜µYçš„ç»´æ•°å¯ä»¥è¡¨ç¤ºæˆm Ã— kã€‚è®¾çŸ©é˜µXä¹˜ä»¥çŸ©é˜µYå¾—åˆ°çš„ç»“æœçŸ©é˜µä¸ºCï¼›çŸ©é˜µCçš„ç»´æ•°ä¸ºn Ã— kï¼Œå…¶ç¬¬iè¡Œç¬¬jåˆ—å…ƒç´ éµå¾ªå¦‚ä¸‹çš„è®¡ç®—å…¬å¼ï¼š

$$c_{ij}=\sum x_{ih}y_{hj}$$

## 

$$C=AB=\begin{bmatrix}
  1&9 &7 \\
  8&1 &2
\end{bmatrix}\begin{bmatrix}
  3&2 &1 &5 \\
  5&4 &7 &3 \\
  6&9 &6 &8
\end{bmatrix}=\begin{bmatrix}
  90&101 &106 &88 \\
  41&38 &27 &59
\end{bmatrix}$$

## çŸ©é˜µçš„è½¬ç½®

::: {layout-ncol="2"}
$$X=\begin{bmatrix}
  x_{11}&x_{12}  &...  &x_{1m} \\
  x_{21}&x_{22}  &...  &x_{2m} \\
  ...&...  &...  &... \\...
  x_{n1}&x_{n2}  &...  &x_{nm}
\end{bmatrix}$$

$$X^T=\begin{bmatrix}
  x_{11}&x_{21}  &...  &x_{n1} \\
  x_{12}&x_{22}  &...  &x_{n2} \\
  ...&...  &...  &... \\...
  x_{1m}&x_{2m}  &...  &x_{nm}
\end{bmatrix}$$
:::

## 

$$A=\begin{bmatrix}
  1&5 \\
  4&8 \\
  7&9
\end{bmatrix}$$

$$A'=A^T=\begin{bmatrix}
  1&4&7 \\
  5&8&9 \\
\end{bmatrix}$$

## å›å½’è¡¨è¾¾å½¢å¼

-   çŸ©é˜µè¡¨è¾¾

$$Y_{nÃ—1}=X_{nÃ—2}\beta_{2Ã—1}+\epsilon_{nÃ—1}$$

::: {layout-ncol="4"}
$$Y_{nÃ—1}=\begin{bmatrix}
  y_1 \\
  y_2 \\
  ... \\
  y_n
\end{bmatrix}$$

$$X_{nÃ—2}=\begin{bmatrix}
  1&x_{12} \\
  1&x_{22} \\
  ...&... \\
  1&x_{n2}
\end{bmatrix}$$

$$\beta_{2Ã—1}=\begin{bmatrix}
 \alpha\\
\beta_1\end{bmatrix}$$

$$\epsilon_{nÃ—1}=\begin{bmatrix}
 \epsilon_1\\
  \epsilon_2\\
  ...\\
  \epsilon_n\end{bmatrix}$$
:::

## 

</br>

æ”¶å…¥ä¸é—®é¢˜è§£å†³èƒ½åŠ›æ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ

</br>

æ•°æ®ï¼š "HouseholdIncome"(æˆ¿äº§æ”¶å…¥)å’Œ"Ravens.score"(ç‘æ–‡æ¨ç†æµ‹éªŒ)è¿™ä¸¤ä¸ªå˜é‡è¿›è¡Œç ”ç©¶(Eisenberg et al., 2019)

## 

$$Y_{nÃ—1}=X_{nÃ—2}\beta_{2Ã—1}+\epsilon_{nÃ—1}$$

$$\begin{bmatrix}
  y_1 \\
  y_2 \\
  ... \\
  y_n
\end{bmatrix}=\begin{bmatrix}
  1&x_{12} \\
  1&x_{22} \\
  ...&... \\
  1&x_{n2}
\end{bmatrix}\begin{bmatrix}
 \alpha\\
\beta_1\end{bmatrix}+\begin{bmatrix}
 \epsilon_1\\
  \epsilon_2\\
  ...\\
  \epsilon_n\end{bmatrix}$$

## 

$$Y_{nÃ—1}=X_{nÃ—2}\beta_{2Ã—1}+\epsilon_{nÃ—1}$$

$$\begin{bmatrix}
  y_1 \\
  y_2 \\
  ... \\
  y_n
\end{bmatrix}=\begin{bmatrix}
  1&x_{Ravens,1} \\
  1&x_{Ravens,2} \\
  ...&... \\
  1&x_{Ravens,n}
\end{bmatrix}\begin{bmatrix}
 \alpha\\
\beta_1\end{bmatrix}+\begin{bmatrix}
 \epsilon_1\\
  \epsilon_2\\
  ...\\
  \epsilon_n\end{bmatrix}$$

# Part 2 å‚æ•°ä¼°è®¡

## æœ€å°äºŒä¹˜æ³•

è¦å»ºç«‹ä¸€å…ƒçº¿æ€§å›å½’æ–¹ç¨‹ï¼Œå°±è¦å…ˆè®¡ç®—æ–¹ç¨‹ä¸­çš„å‚æ•°aå’Œbã€‚æ ¹æ®æœ€ä½³æ‹ŸåˆåŸåˆ™ï¼Œå›å½’çº¿æ˜¯æŒ‡æ•£ç‚¹å›¾ä¸­æ¯ä¸€ä¸ªç‚¹æ²¿Yè½´æ–¹å‘åˆ°è¯¥ç›´çº¿çš„è·ç¦»å¹³æ–¹å’Œæœ€å°çš„é‚£æ¡ç›´çº¿ï¼Œå³ä½¿è¯¯å·®å¹³æ–¹å’Œæœ€å°ï¼Œè¿™å°±æ˜¯å¸¸è§„æœ€å°äºŒä¹˜æ³•(ordinary least squares, OLS)çš„åŸºæœ¬æ€æƒ³ã€‚

## 

```{r}
require('pacman')
p_load('tidyverse','bruceR','papaja')
```

```{r}
# è¯»å–æ•°æ®å¹¶é€‰å–æ„Ÿå…´è¶£çš„å˜é‡
df <- read.csv('data/example5.csv')%>%
  select(HouseholdIncome,ravens.score)
# å°†å˜é‡è¿›è¡Œå½’ä¸€åŒ–è·å¾—ä¸¤åˆ—å˜é‡çš„æ ‡å‡†åˆ†æ•°
df_norm <- as.data.frame(scale(df))
#df_norm
```

```{r}
# çº¿æ€§å›å½’
lm_model <- lm(HouseholdIncome~ravens.score,data=df_norm) 
```

```{r}
# è®¡ç®—ç‚¹åˆ°å›å½’çº¿çš„å‚ç›´è·ç¦»
df_norm <- df_norm %>%
  mutate(
    lm_value = -5.480e-17 + 1.234e-01 * ravens.score, # æœ€ä½³æ‹Ÿåˆç›´çº¿æ‹Ÿåˆå€¼
    nl_value1 = -1 + 1.234e-01 * ravens.score, # éæœ€ä½³æ‹Ÿåˆç›´çº¿æ‹Ÿåˆå€¼
    nl_value2 = 1 + 1.234e-01 * ravens.score  # éæœ€ä½³æ‹Ÿåˆç›´çº¿æ‹Ÿåˆå€¼
  )
```

```{r}
ggplot(data = df_norm, mapping = aes(x=ravens.score,y=HouseholdIncome))+
  geom_point(color="orange")+# æ•£ç‚¹å›¾
  geom_smooth(method = "lm", se = FALSE, color = "black")+ # æ‹Ÿåˆç›´çº¿
  geom_segment(aes(x=ravens.score, y=HouseholdIncome, xend = ravens.score, yend =lm_value), color = "orange", linewidth = 0.5) +  # æ·»åŠ è·ç¦»çº¿æ®µ
  annotate("text", x = -1.5, y = 5, label ="Î±*,Î²*=argmin Î£ Îµ^2", size = 5)+ # æ·»åŠ æ–‡å­—
  theme_apa()# apaæ ¼å¼ä¸»é¢˜
```

```{r}
ggplot(data = df_norm, mapping = aes(x=ravens.score,y=HouseholdIncome))+
  geom_point(color="orange")+# æ•£ç‚¹å›¾
  geom_abline(intercept = -1, slope = 1.234e-01, color = "black") +# éæœ€ä½³æ‹Ÿåˆç›´çº¿
  geom_segment(aes(x=ravens.score, y=HouseholdIncome, xend = ravens.score, yend =nl_value1), color = "orange", linewidth = 0.5) +  # æ·»åŠ è·ç¦»çº¿æ®µ
  annotate("text", x = -1.5, y = 5, label ="Î±*,Î²*â‰ argmin Î£ Îµ^2", size = 5)+ # æ·»åŠ æ–‡å­—
  theme_apa() # apaæ ¼å¼ä¸»é¢˜
```

```{r}
ggplot(data = df_norm, mapping = aes(x=ravens.score,y=HouseholdIncome))+
  geom_point(color="orange")+# æ•£ç‚¹å›¾
  geom_abline(intercept = 1, slope = 1.234e-01, color = "black") +# éæœ€ä½³æ‹Ÿåˆç›´çº¿
  geom_segment(aes(x=ravens.score, y=HouseholdIncome, xend = ravens.score, yend =nl_value2), color = "orange", linewidth = 0.5) +  # æ·»åŠ è·ç¦»çº¿æ®µ
  annotate("text", x = -1.5, y = 5, label ="Î±*,Î²*â‰ argmin Î£ Îµ^2", size = 5)+ # æ·»åŠ æ–‡å­—
  theme_apa() # apaæ ¼å¼ä¸»é¢˜
```

## ä¸€èˆ¬å½¢å¼

$$\alpha^*,\beta^*=argmin\sum \epsilon^2$$

$$\downarrow$$

$$\alpha^*,\beta^*=argmin\sum(Y-a-bX)^2$$

## 

$$\alpha^*,\beta^*=argmin\sum(Y-a-bX)^2$$ $$\downarrow$$

è¦ä½¿$\sum(Y-a-bX)^2$æœ€å°ï¼Œåˆ™$\frac{\partial \sum(Y-a-bX)^2}{\partial a}=0$, $\frac{\partial \sum(Y-a-bX)^2}{\partial b}=0$

$$\downarrow$$ å³$-2\sum(Y-a-bX)=0$,$-2\sum(XY-aX-bX^2)=0$

$$\downarrow$$ $a=\bar{Y}-b\bar{X}$ $b=\frac{\sum(X-\bar{X})(Y-\bar{Y})}{\sum(X-\bar{X})^2}=\frac{\sum XY-\frac{\sum X\sum Y}{n}}{\sum X^2-\frac{(\sum X)^2}{n}}$

## 

![](images/6.5.jpg)

$$ä»¤\frac{\partial \sum(Y-a-bX)^2}{\partial a}=0, \frac{\partial \sum(Y-a-bX)^2}{\partial b}=0$$

$$(\alpha^*,\beta^*)ä½äºæœ€ä½ç‚¹$$ $$\sum(y-a-bX)^2æœ€å°$$

## çŸ©é˜µå½¢å¼

$$Y=X\beta+\epsilon$$

::: {layout-ncol="3"}
$$\epsilon_{nÃ—1}=\begin{bmatrix}
 \epsilon_1\\
  \epsilon_2\\
  ...\\
  \epsilon_n\end{bmatrix}$$

$$\epsilon_{nÃ—1}^T=\begin{bmatrix}
 \epsilon_1\\
  \epsilon_2\\
  ...\\
  \epsilon_n\end{bmatrix}^T$$

$$\epsilon_{nÃ—1}^T\epsilon_{nÃ—1}=\begin{bmatrix}
 \epsilon_1\\
  \epsilon_2\\
  ...\\
  \epsilon_n\end{bmatrix}^T\begin{bmatrix}
 \epsilon_1\\
  \epsilon_2\\
  ...\\
  \epsilon_n\end{bmatrix}=\sum \epsilon_i^2$$
:::

## ç”¨çŸ©é˜µå½¢å¼è¡¨è¾¾å…¶æ®‹å·®å¹³æ–¹å’Œ

</br>

$Y=X\beta+\epsilon$

</br>

$\begin{aligned}  SS_R=& \epsilon'\epsilon\\  =&(y-XÎ²)'(y-XÎ²)\\  =&y'y-Î²'X'y-y'XÎ²+Î²'X'XÎ²\\  =&y'y-2y'XÎ²+Î²'X'XÎ²  \end{aligned}$

</br> ç”¨çŸ©é˜µå½¢å¼è¡¨è¾¾å…¶æ®‹å·®å¹³æ–¹å’Œ

## æ¢¯åº¦ä¸‹é™æ³•

åœ¨è®¡ç®—é‡è¾ƒå°æ—¶ï¼Œç›´æ¥æ±‚å¯¼å¾—åˆ°è§£æè§£é€Ÿåº¦å ä¼˜(å¦‚æœ€å°äºŒä¹˜æ³•)ï¼Œä½†æ˜¯å½“æ•°æ®é‡å¾ˆå¤§æ—¶ï¼Œæ›´é€‚åˆåˆ©ç”¨è®¡ç®—æœºè¿­ä»£å¼çš„æ¢¯åº¦ä¸‹é™æ³•è¿›è¡Œæ±‚è§£ã€‚ æ¢¯åº¦ä¸‹é™æ³•çš„å·¥ä½œæ–¹å¼æ˜¯åœ¨æ¯æ¬¡è¿­ä»£ä¸­æ²¿è´Ÿæ¢¯åº¦æ–¹å‘æ›´æ–°å‚æ•°ï¼Œä½¿å¹³å‡å¹³æ–¹è¯¯å·®æœ€å°ã€‚

$$\hat{\beta_{t+1}} = \hat{\beta_t}-\gamma \bigtriangledown F(\hat{\beta_t})$$

## 

![](images/6.6.png)
    
$$\hat{\beta_{t+1}} = \hat{\beta_t}-\gamma \bigtriangledown F(\hat{\beta_t})$$

$$\downarrow$$

$$\bigtriangledown F(\hat{\beta_t})=(\frac{\partial F}{\partial \beta_0},\frac{\partial F}{\partial \beta_1})$$ <br>æŸä¸€ç‚¹çš„æ¢¯åº¦æ–¹å‘ä¸ºå‡½æ•°åœ¨è¯¥ç‚¹çš„å¯¼æ•°


## æ¢¯åº¦ä¸‹é™æ³•åœ¨çº¿æ€§å›å½’å‚æ•°ä¼°è®¡ä¸­çš„è¡¨ç°

![](images/6.7.png)

## 

![](images\6.5.gif)

# Part 3 åŸºæœ¬å‡å®šå’Œworkflow

## åŸºæœ¬å‡å®š

1.  æ¨¡å‹è®¾å®šå‡å®š(çº¿æ€§é¢„è®¾)

2.  æ­£äº¤é¢„è®¾

3.  æ®‹å·®æ–¹å·®é½æ€§é¢„è®¾

4.  æ­£æ€åˆ†å¸ƒé¢„è®¾

## 1.çº¿æ€§é¢„è®¾

(1)è¯¥é¢„è®¾è§„å®šYçš„æ¡ä»¶å‡å€¼æ˜¯è‡ªå˜é‡Xçš„çº¿æ€§å‡½æ•°ï¼Œè‹¥å˜é‡ä¹‹é—´æ˜¯éçº¿æ€§å…³ç³»ï¼Œçº¿æ€§å›å½’çš„æ‹Ÿåˆæ•ˆæœä¸ä½³ï¼› ![](images\6.8.png)

## 

(2)åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šé‡åˆ°éçº¿æ€§å‡½æ•°çš„å½¢å¼ã€‚æœ€å¸¸è§çš„å˜æ¢æ–¹å¼å°±æ˜¯å¯¹æ•°å˜æ¢ã€‚ ![](images\6.10.png)

## 2. æ­£äº¤é¢„è®¾

(1)è¯¯å·®é¡¹ğå’Œxä¸ç›¸å…³ï¼›

(2)è¯¯å·®é¡¹ğçš„æœŸæœ›å€¼ä¸º0ã€‚

æ³¨æ„ï¼šä¸ç®¡æ­£äº¤å‡å®šæ˜¯å¦æˆç«‹ï¼Œæœ€å°äºŒä¹˜ä¼°è®¡åœ¨è®¡ç®—ä¸­å·²è¿ç”¨äº†è¿™ä¸€é¢„è®¾ã€‚

## 2. æ­£äº¤é¢„è®¾

è‹¥è¯¯å·®é¡¹ğçš„æœŸæœ›å€¼ä¸ä¸º0ï¼Œ

</br>

E(y)=E(a+bx)+E(Ïµ)ã€‚

</br>

å¦‚æœE(ğ)ä¸ä¸ºé›¶ï¼Œå›å½’ç³»æ•°å°†æœ‰æ— ç©·è§£ï¼Œç»“æœå°±æ˜¯æ€»ä½“å›å½’æ–¹ç¨‹æ— æ³•é€šè¿‡æ ·æœ¬å»ä¼°è®¡ã€‚

## 3. æ®‹å·®æ–¹å·®é½æ€§

å¯¹Xå˜é‡çš„æ¯ä¸€ä¸ªå¯èƒ½çš„å€¼ï¼ŒYå˜é‡æœ‰ç›¸åŒçš„æ€»ä½“æ–¹å·®ã€‚å³æ®‹å·®çš„æ–¹å·®ä¸å—Xå˜é‡å–å€¼çš„å½±å“ã€‚

![](images\6.9.jpg)

## 3. æ®‹å·®æ–¹å·®é½æ€§

è‹¥æ®‹å·®æ–¹å·®ä¸é½æ€§ï¼Œè¯¯å·®è¾ƒå¤§çš„è§‚æµ‹å€¼å°†å¯¹æ‹Ÿåˆæ¨¡å‹äº§ç”Ÿæ›´å¤§çš„å½±å“ã€‚ ![](images\6.11.png)

## 4. æ®‹å·®æ­£æ€åˆ†å¸ƒé¢„è®¾

-   è¯¥é¢„è®¾è§„å®šæ®‹å·®é¡¹ğç‹¬ç«‹ä¸”åŒåˆ†å¸ƒã€‚
-   å®é™…ä¸­æ— æ³•ç¡®å®šğçš„åˆ†å¸ƒã€‚
-   å¯¹äºå¤§æ ·æœ¬æ•°æ®ï¼Œå¯æ ¹æ®ä¸­å¿ƒæé™å®šç†å¯¹å‚æ•°è¿›è¡Œç»Ÿè®¡æ¨æ–­ã€‚ç„¶è€Œåœ¨å°æ ·æœ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªæœ‰å‡å®šğæœä»æ­£æ€åˆ†å¸ƒæ—¶æ‰èƒ½ä½¿ç”¨tæ£€éªŒã€‚

## 4. æ®‹å·®æ­£æ€åˆ†å¸ƒé¢„è®¾

è‹¥ğä¸æ»¡è¶³æ­£æ€åˆ†å¸ƒé¢„è®¾ï¼ŒOLSçš„ä¼°è®¡æ˜¯æœ‰åçš„ã€‚

## WorkFlow

"HouseholdIncome"(æˆ¿äº§æ”¶å…¥)å’Œ"Ravens.score"(ç‘æ–‡æ¨ç†æµ‹éªŒ) æ˜¯å¦å­˜åœ¨çº¿æ€§å…³ç³»ï¼Ÿ

## workflow

1.  æå‡ºä¸ç ”ç©¶å‡è®¾å¯¹åº”çš„ç»Ÿè®¡å‡è®¾

2.  é€‰æ‹©ç»Ÿè®¡æ¨¡å‹

3.  ç¡®å®šæ˜¾è‘—æ€§æ°´å¹³

4.  åŸºäºH0çš„ç»Ÿè®¡æ¨¡å‹ï¼Œè®¡ç®—ç»Ÿè®¡é‡

5.  åšå‡ºç»Ÿè®¡æ¨æ–­

## 1. æå‡ºä¸ç ”ç©¶å‡è®¾å¯¹åº”çš„ç»Ÿè®¡å‡è®¾

-   å›å½’åˆ†æä¸­çš„ä¸¤ä¸ªå‡è®¾æ£€éªŒ

    -   æ¨¡å‹æ•´ä½“æ£€éªŒ

        -   H0: ä¸¤å˜é‡ä¹‹é—´ä¸å­˜åœ¨çº¿æ€§å…³ç³»

        -   H1: ä¸¤å˜é‡ä¹‹é—´å­˜åœ¨çº¿æ€§å…³ç³»

    -   å›å½’ç³»ç»Ÿçš„æ˜¾è‘—æ€§æ£€éªŒ

        -   H0: ğ›½_1=0

        -   H1: ğ›½_1â‰ 0

## 

```{r}
ggplot(data = df, mapping = aes(x=ravens.score,y=HouseholdIncome))+
  geom_point(color="orange")+# æ•£ç‚¹å›¾
  theme_apa()# apaæ ¼å¼ä¸»é¢˜
```

## 2. æ£€éªŒçº¿æ€§å›å½’çš„é¢„è®¾

```{r echo=TRUE}
library(psych)
desc_stats <- describe(df)
desc_stats
```

## 

æ£€éªŒå¦‚ä¸‹é¢„è®¾ï¼š

-   æ¨¡å‹è®¾å®šå‡å®š(çº¿æ€§é¢„è®¾)

-   æ­£äº¤é¢„è®¾

-   æ®‹å·®æ–¹å·®é½æ€§

-   æ®‹å·®æ­£æ€åˆ†å¸ƒ

## çº¿æ€§å‡å®š&æ­£äº¤

```{r echo=TRUE}
# æ‹Ÿåˆçº¿æ€§å›å½’æ¨¡å‹
linear_model <- lm(HouseholdIncome ~ ravens.score, data = df)

# è·å–çº¿æ€§å›å½’æ¨¡å‹çš„æ®‹å·®
residuals <- resid(linear_model)

# æ£€éªŒçº¿æ€§å‡è®¾
plot(linear_model,which=1)
```

å‚è€ƒçº¿æ¥è¿‘æ°´å¹³ï¼Œç¬¦åˆçº¿æ€§é¢„è®¾

## æ®‹å·®æ–¹å·®é½æ€§

```{r echo=TRUE}
# æ£€éªŒæ®‹å·®æ–¹å·®é½æ€§
plot(linear_model,which=3)
```

è¯¯å·®é¡¹ğçš„æ–¹å·®é½æ€§

## æ®‹å·®æ­£æ€åˆ†å¸ƒ

```{r echo=TRUE}
# æ£€éªŒæ®‹å·®æ­£æ€åˆ†å¸ƒ
plot(linear_model,which=2)
```

æ®‹å·®çš„åˆ†å¸ƒä¸ç¬¦åˆæ­£æ€åˆ†å¸ƒ (p \< .001)ã€‚

## 3. ç¡®å®šæ˜¾è‘—æ€§æ°´å¹³

ä½¿ç”¨ä¼ ç»Ÿçš„ alpha = .05

## 4. è®¡ç®—ç»Ÿè®¡é‡

</br>

æ¨¡å‹æ•´ä½“æ£€éªŒ:

è¯¥æ¨¡å‹åœ¨ç»Ÿè®¡ä¸Šè§£é‡Šäº†ä¸€å°éƒ¨åˆ†ä½†ç»Ÿè®¡ä¸Šæ˜¾è‘—çš„å˜å¼‚ï¼š

$R^2=0.02, F(1, 520) = 8.05, p = 0.005, adj. R^2 = 0.01$

</br> å›å½’ç³»æ•°æ£€éªŒ: ç‘æ–‡æ¨ç†åˆ†æ•°åœ¨ç»Ÿè®¡ä¸Šå…·æœ‰ç§¯æä¸”æ˜¾è‘—çš„æ•ˆåº”ï¼š

$Î² = 896.95ï¼Œ95\% CI [275.78, 1518.12]ï¼Œt(520) = 2.84, p = 0.005, std. beta = 0.12, 95\% CI [0.04, 0.21]$

## 

```{r}
library(gridExtra)
# è®¡ç®—ç›¸å…³ç³»æ•° r
cor<- cor.test(df$ravens.score, df$HouseholdIncome)

# åˆ›å»ºåŒ…å«ç›¸å…³ç³»æ•°å’Œç½®ä¿¡åŒºé—´çš„æ•°æ®æ¡†
cor_df <- data.frame(
  "Variable" = "r",
  "Correlation" = round(cor$estimate,3),
  "CI_Lower" = round(cor$conf.int[1],3),
  "CI_Upper" = round(cor$conf.int[2],3)
)

#ç”»æ•£ç‚¹å›¾å’Œå›å½’çº¿
scatter_plot<-ggplot(df,aes(x =ravens.score, y=HouseholdIncome))+
  geom_point(color="grey")+# æ•£ç‚¹å›¾
  geom_smooth(method = "lm", se = TRUE, color = "black")+
  theme_apa()

#ç”»HouseholdIncomeçš„ç›´æ–¹å›¾å’Œå¯†åº¦æ›²çº¿
hist_income<-ggplot(df, aes(x =HouseholdIncome )) +
  geom_histogram(
    mapping = aes(y = ..density..), 
    alpha = 0.6) +
  geom_density(size = 1.1)+
  theme_apa()

#ç”»ravens.scoreçš„ç›´æ–¹å›¾å’Œå¯†åº¦æ›²çº¿
hist_ravens<-ggplot(df, aes(x =ravens.score)) +
  geom_histogram(
    mapping = aes(y = ..density..), 
    alpha = 0.6) +
  geom_density(size = 1.1)+
  theme_apa()

#å°†ä¸Šè¿°å›¾è¡¨æ•´åˆä¸ºå››å®«æ ¼å‘ˆç°
grid.arrange(scatter_plot, hist_income, hist_ravens,  tableGrob(cor_df), ncol = 2, nrow = 2)
```


## 5. ç»Ÿè®¡æ¨æ–­ï¼ˆåšå‡ºå†³ç­–ï¼‰

ä½¿ç”¨ç®€å•çº¿æ€§æ¨¡å‹æ£€éªŒç‘æ–‡æ¨ç†çš„åˆ†æ•°ä¸å®¶åº­æ”¶å…¥çš„å…³ç³»ã€‚ç»“æœè¡¨æ˜è¯¥æ¨¡å‹æ˜¾è‘—åœ°è§£é‡Šäº†ä¸€éƒ¨åˆ†å˜å¼‚ï¼Œ$R^2=0.02ã€‚F(1, 520) = 8.05, p = 0.005, adj. R2 = 0.01$ã€‚ç‘æ–‡æ¨ç†åˆ†æ•°å¯¹å®¶åº­æ”¶å…¥çš„é¢„æµ‹åœ¨ç»Ÿè®¡ä¸Šå…·æœ‰ç§¯æçš„æ•ˆåº”ï¼Œ$Î² = 896.95ï¼Œ95\% CI [275.78, 1518.12]ï¼Œt(520) = 2.84, p = 0.005; Std. beta = 0.12, 95\% CI [0.04, 0.21]$ã€‚

# æ€»ç»“

-   ä¸€å…ƒçº¿æ€§å›å½’çš„è¡¨è¾¾å½¢å¼

-   ä¸€å…ƒçº¿æ€§å›å½’ä¸­å‚æ•°(intercept, slope)çš„ä¼°è®¡

-   åŸºæœ¬é¢„è®¾ä¸workflow
